"use strict";(self.webpackChunkvue_admin_better=self.webpackChunkvue_admin_better||[]).push([["1026"],{42738:function(e,a,t){t.r(a),t.d(a,{createScheme:function(){return u},deleteScheme:function(){return o},getScheme:function(){return r},getSchemes:function(){return l},updateScheme:function(){return i}});var n=t(49289);function l(e={}){return n.default.get("/admin/form-schemes",{params:e}).then(e=>e.data)}function r(e){return n.default.get(`/admin/form-schemes/${e}`).then(e=>e.data)}function u(e){return n.default.post("/admin/form-schemes",e).then(e=>e.data)}function i(e,a){return n.default.patch(`/admin/form-schemes/${e}`,a).then(e=>e.data)}function o(e){return n.default.delete(`/admin/form-schemes/${e}`).then(()=>!0)}},23948:function(e,a,t){var n=t(15058),l=t.n(n),r=t(9915),u=t.n(r)()(l());u.push([e.id,"\n.scheme-page[data-v-1b3864d6] {\n  padding: 20px;\n  background-color: #fff;\n  min-height: calc(100vh - 120px);\n}\n.toolbar[data-v-1b3864d6] {\n  display: flex;\n  align-items: center;\n  margin-bottom: 16px;\n  gap: 12px;\n}\n.grow[data-v-1b3864d6] {\n  flex: 1;\n}\n.w-64[data-v-1b3864d6] {\n  width: 260px;\n}\n.w-40[data-v-1b3864d6] {\n  width: 180px;\n}\n.pager[data-v-1b3864d6] {\n  margin-top: 16px;\n  display: flex;\n  justify-content: flex-end;\n}\n.tpl-team[data-v-1b3864d6] {\n  font-size: 12px;\n  color: #999;\n  margin-left: 4px;\n}\n.text-muted[data-v-1b3864d6] {\n  color: #bbb;\n}\n.mt-4[data-v-1b3864d6] {\n  margin-top: 16px;\n}\n",""]),a.A=u},78505:function(e,a,t){t.r(a),t.d(a,{default:function(){return F}});var n=t(79754),l=t(79458),r=t(29986),u=t(42738);let i={class:"scheme-page"},o={class:"toolbar"},s={key:0},d={key:0,class:"tpl-team"},p={key:1,class:"text-muted"},c={key:1,class:"pager"};var g=t(66270),m=t.n(g),f=t(38007),v=t.n(f),b=t(92669),h=t.n(b),y=t(23566),k=t.n(y),S=t(76106),w=t.n(S),_=t(12527),x=t.n(_),z=t(23948),C={};C.styleTagTransform=x(),C.setAttributes=k(),C.insert=h().bind(null,"head"),C.domAPI=v(),C.insertStyleElement=w(),m()(z.A,C),z.A&&z.A.locals&&z.A.locals;var F=(0,t(16784).default)({__name:"index",setup(e){let a=(0,l.rd)(),t=(0,n.KR)(""),g=(0,n.KR)(),m=(0,n.KR)([]),f=(0,n.KR)(!1),v=(0,n.KR)({page:1,pageSize:20,total:0});async function b(){f.value=!0;try{let e={page:v.value.page,pageSize:v.value.pageSize,keyword:t.value||void 0,status:g.value??void 0},a=await (0,u.getSchemes)(e);console.log("getSchemes =>",a),m.value=Array.isArray(a?.list)?a.list:[],a?.pagination&&(v.value={page:Number(a.pagination.page)||v.value.page,pageSize:Number(a.pagination.pageSize)||v.value.pageSize,total:Number(a.pagination.total)||0})}catch(e){console.error(e),r.n.error("加载方案失败："+(e.message||"服务器异常")),m.value=[]}finally{f.value=!1}}function h(){v.value.page=1,b()}function y(e){v.value.page=e,b()}function k(e){v.value.pageSize=e,v.value.page=1,b()}function S(){a.push({path:"/form-schemes/edit",query:{mode:"new"}})}async function w(e){try{await (0,u.deleteScheme)(e),r.n.success("删除成功！"),1===m.value.length&&v.value.page>1&&(v.value.page-=1),b()}catch(e){console.error(e),r.n.error("删除失败："+(e.message||"操作异常"))}}return(0,n.sV)(b),(e,l)=>{let r=(0,n.g2)("el-input"),u=(0,n.g2)("el-option"),b=(0,n.g2)("el-select"),_=(0,n.g2)("el-button"),x=(0,n.g2)("el-table-column"),z=(0,n.g2)("el-tag"),C=(0,n.g2)("el-popconfirm"),F=(0,n.g2)("el-table"),N=(0,n.g2)("el-empty"),A=(0,n.g2)("el-pagination"),W=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Q3)(" 工具栏 "),(0,n.Lk)("div",o,[(0,n.bF)(r,{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),clearable:"",placeholder:"搜索方案名称",class:"w-64",onKeyup:(0,n.jR)(h,["enter"]),onClear:h},null,8,["modelValue"]),(0,n.bF)(b,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=e=>g.value=e),clearable:"",placeholder:"状态",class:"w-40",onChange:h},{default:(0,n.k6)(()=>[(0,n.bF)(u,{value:1,label:"启用"}),(0,n.bF)(u,{value:2,label:"草稿"}),(0,n.bF)(u,{value:0,label:"停用"})]),_:1},8,["modelValue"]),l[5]||(l[5]=(0,n.Lk)("div",{class:"grow"},null,-1)),(0,n.bF)(_,{type:"primary",onClick:S},{default:(0,n.k6)(()=>[...l[4]||(l[4]=[(0,n.eW)("新建方案",-1)])]),_:1})]),(0,n.Q3)(" 表格 "),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(F,{data:m.value,border:"","header-row-class-name":"table-header",size:"small"},{default:(0,n.k6)(()=>[(0,n.bF)(x,{prop:"name",label:"方案名称","min-width":"220","show-overflow-tooltip":""}),(0,n.bF)(x,{prop:"templateName",label:"关联模板","min-width":"200","show-overflow-tooltip":""},{default:(0,n.k6)(({row:e})=>[e.templateName?((0,n.uX)(),(0,n.CE)("span",s,[(0,n.eW)((0,n.v_)(e.templateName)+" ",1),e.teamName?((0,n.uX)(),(0,n.CE)("span",d," （"+(0,n.v_)(e.teamName)+"） ",1)):(0,n.Q3)("v-if",!0)])):((0,n.uX)(),(0,n.CE)("span",p,"-"))]),_:1}),(0,n.bF)(x,{prop:"status",label:"状态",width:"120",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(z,{type:function(e){switch(e){case 0:return"info";case 1:return"success";case 2:return"warning";default:return"default"}}(e.status),size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,n.v_)(function(e){switch(e){case 0:return"停用";case 1:return"启用";case 2:return"草稿";default:return String(e??"")}}(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)(x,{prop:"createdAt",label:"创建时间",width:"180",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.eW)((0,n.v_)(function(e){if(!e)return"";try{let a="string"==typeof e?new Date(e):e;if(Number.isNaN(a.getTime()))return String(e);let t=a.getFullYear(),n=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0"),r=String(a.getHours()).padStart(2,"0"),u=String(a.getMinutes()).padStart(2,"0");return`${t}-${n}-${l} ${r}:${u}`}catch{return String(e)}}(e.createdAt)),1)]),_:1}),(0,n.bF)(x,{label:"操作",width:"200",fixed:"right",align:"center"},{default:(0,n.k6)(({row:e})=>[(0,n.bF)(_,{size:"small",type:"primary",link:"",onClick:t=>{var n;return n=e.id,void a.push({path:"/form-schemes/edit",query:{id:String(n)}})}},{default:(0,n.k6)(()=>[...l[6]||(l[6]=[(0,n.eW)(" 编辑 ",-1)])]),_:1},8,["onClick"]),(0,n.bF)(C,{title:"确认删除此方案？",onConfirm:a=>w(e.id)},{reference:(0,n.k6)(()=>[(0,n.bF)(_,{size:"small",type:"danger",link:""},{default:(0,n.k6)(()=>[...l[7]||(l[7]=[(0,n.eW)(" 删除 ",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,f.value]]),(0,n.Q3)(" 空状态 "),f.value||0!==m.value.length?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.Wv)(N,{key:0,description:"暂无方案",class:"mt-4"},{extra:(0,n.k6)(()=>[(0,n.bF)(_,{type:"primary",onClick:S},{default:(0,n.k6)(()=>[...l[8]||(l[8]=[(0,n.eW)("去新建",-1)])]),_:1})]),_:1})),(0,n.Q3)(" 分页 "),v.value.total>0?((0,n.uX)(),(0,n.CE)("div",c,[(0,n.bF)(A,{"current-page":v.value.page,"onUpdate:currentPage":l[2]||(l[2]=e=>v.value.page=e),"page-size":v.value.pageSize,"onUpdate:pageSize":l[3]||(l[3]=e=>v.value.pageSize=e),total:v.value.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:y,onSizeChange:k},null,8,["current-page","page-size","total"])])):(0,n.Q3)("v-if",!0)])}}},[["__scopeId","data-v-1b3864d6"]])}}]);