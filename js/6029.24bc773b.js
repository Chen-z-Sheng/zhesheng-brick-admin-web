"use strict";(self.webpackChunkvue_admin_better=self.webpackChunkvue_admin_better||[]).push([["6029"],{42738:function(e,a,t){t.r(a),t.d(a,{createScheme:function(){return u},deleteScheme:function(){return o},getScheme:function(){return r},getSchemes:function(){return n},updateScheme:function(){return d}});var l=t(49289);function n(e={}){return l.default.get("/admin/form-schemes",{params:e}).then(e=>e.data)}function r(e){return l.default.get(`/admin/form-schemes/${e}`).then(e=>e.data)}function u(e){return l.default.post("/admin/form-schemes",e).then(e=>e.data)}function d(e,a){return l.default.patch(`/admin/form-schemes/${e}`,a).then(e=>e.data)}function o(e){return l.default.delete(`/admin/form-schemes/${e}`).then(()=>!0)}},60466:function(e,a,t){t.r(a),t.d(a,{createFormTemplate:function(){return u},deleteFormTemplate:function(){return o},getFormTemplate:function(){return r},getFormTemplates:function(){return n},updateFormTemplate:function(){return d}});var l=t(49289);function n(e={}){return l.default.get("/admin/form-template",{params:e}).then(e=>e.data)}function r(e){return l.default.get(`/admin/form-template/${e}`).then(e=>e.data)}function u(e){return l.default.post("/admin/form-template",e).then(e=>e.data)}function d(e,a){return l.default.patch(`/admin/form-template/${e}`,a).then(e=>e.data)}function o(e){return l.default.delete(`/admin/form-template/${e}`).then(()=>!0)}},29531:function(e,a,t){var l=t(15058),n=t.n(l),r=t(9915),u=t.n(r)()(n());u.push([e.id,".designer-page[data-v-3a9e0d7b]{display:flex;flex-direction:column;gap:12px;padding:12px}.topbar[data-v-3a9e0d7b]{display:flex;align-items:center;gap:8px}.grow[data-v-3a9e0d7b]{flex:1}.w-56[data-v-3a9e0d7b]{width:260px}.form-wrap[data-v-3a9e0d7b]{background:#fff;border-radius:8px;padding:16px 20px 24px;box-sizing:border-box}",""]),a.A=u},24988:function(e,a,t){t.r(a),t.d(a,{default:function(){return V}});var l=t(79754),n=t(79458),r=t(29986),u=t(42738),d=t(60466);let o={class:"designer-page"},i={class:"topbar"},s={class:"form-wrap"};var m=t(66270),c=t.n(m),f=t(38007),p=t.n(f),g=t(92669),v=t.n(g),b=t(23566),h=t.n(b),k=t(76106),y=t.n(k),_=t(12527),F=t.n(_),w=t(29531),x={};x.styleTagTransform=F(),x.setAttributes=h(),x.insert=v().bind(null,"head"),x.domAPI=p(),x.insertStyleElement=y(),c()(w.A,x),w.A&&w.A.locals&&w.A.locals;var V=(0,t(16784).default)({__name:"designer",setup(e){let a=(0,n.lq)(),t=(0,n.rd)(),m=(0,l.KR)(a.query.id?String(a.query.id):null),c=(0,l.EW)(()=>"new"===a.query.mode||!m.value),f=(0,l.KR)(),p=(0,l.KR)(!1),g=(0,l.KR)({name:"",templateId:"",description:"",status:1}),v={name:[{required:!0,message:"请输入方案名称",trigger:"blur"}],templateId:[{required:!0,message:"请选择模板",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},b=(0,l.KR)([]);async function h(){try{let e=await (0,d.getFormTemplates)({pageSize:100});b.value=Array.isArray(e?.list)?e.list:[]}catch(e){console.error(e),r.n.error("加载模板列表失败："+(e.message||"接口异常"))}}async function k(){if(!c.value&&m.value)try{let e=await (0,u.getScheme)(m.value);g.value={name:e.name??"",templateId:e.templateId??"",description:e.description??"",status:"number"==typeof e.status?e.status:1}}catch(e){console.error(e),r.n.error("加载方案失败："+(e.message||"接口异常"))}}function y(){f.value?.validate(async e=>{if(e){p.value=!0;try{let e={name:g.value.name,templateId:g.value.templateId,description:g.value.description||null,status:g.value.status};c.value?(await (0,u.createScheme)(e),r.n.success("方案创建成功"),_()):m.value&&(await (0,u.updateScheme)(m.value,e),r.n.success("方案更新成功"))}catch(e){console.error(e),r.n.error("保存失败："+(e.message||"接口异常"))}finally{p.value=!1}}})}function _(){t.back()}return(0,l.sV)(async()=>{await h(),await k()}),(e,a)=>{let t=(0,l.g2)("el-page-header"),n=(0,l.g2)("el-button"),r=(0,l.g2)("el-input"),u=(0,l.g2)("el-form-item"),d=(0,l.g2)("el-option"),m=(0,l.g2)("el-select"),h=(0,l.g2)("el-radio"),k=(0,l.g2)("el-radio-group"),F=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("div",i,[(0,l.bF)(t,{onBack:_},{content:(0,l.k6)(()=>[(0,l.Lk)("span",null,(0,l.v_)(c.value?"新建方案":"编辑方案"),1)]),_:1}),a[6]||(a[6]=(0,l.Lk)("div",{class:"grow"},null,-1)),(0,l.bF)(n,{loading:p.value,type:"primary",onClick:y},{default:(0,l.k6)(()=>[...a[4]||(a[4]=[(0,l.eW)(" 保存 ",-1)])]),_:1},8,["loading"]),(0,l.bF)(n,{onClick:_},{default:(0,l.k6)(()=>[...a[5]||(a[5]=[(0,l.eW)("返回",-1)])]),_:1})]),(0,l.Lk)("div",s,[(0,l.bF)(F,{ref_key:"formRef",ref:f,model:g.value,rules:v,"label-width":"96px"},{default:(0,l.k6)(()=>[(0,l.bF)(u,{label:"方案名称",prop:"name"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{modelValue:g.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>g.value.name=e),placeholder:"例如：11.11京东珀莱雅222本845回900"},null,8,["modelValue"])]),_:1}),(0,l.bF)(u,{label:"关联模板",prop:"templateId"},{default:(0,l.k6)(()=>[(0,l.bF)(m,{modelValue:g.value.templateId,"onUpdate:modelValue":a[1]||(a[1]=e=>g.value.templateId=e),placeholder:"请选择模板",filterable:"",class:"w-56"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.value,e=>((0,l.uX)(),(0,l.Wv)(d,{key:e.id,label:`${e.name}（${e.teamName}）`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(u,{label:"方案说明"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{modelValue:g.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>g.value.description=e),type:"textarea",rows:3,placeholder:"可选，给自己/团队看的备注说明"},null,8,["modelValue"])]),_:1}),(0,l.bF)(u,{label:"状态",prop:"status"},{default:(0,l.k6)(()=>[(0,l.bF)(k,{modelValue:g.value.status,"onUpdate:modelValue":a[3]||(a[3]=e=>g.value.status=e)},{default:(0,l.k6)(()=>[(0,l.bF)(h,{label:1},{default:(0,l.k6)(()=>[...a[7]||(a[7]=[(0,l.eW)("启用",-1)])]),_:1}),(0,l.bF)(h,{label:2},{default:(0,l.k6)(()=>[...a[8]||(a[8]=[(0,l.eW)("草稿",-1)])]),_:1}),(0,l.bF)(h,{label:0},{default:(0,l.k6)(()=>[...a[9]||(a[9]=[(0,l.eW)("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])])}}},[["__scopeId","data-v-3a9e0d7b"]])}}]);