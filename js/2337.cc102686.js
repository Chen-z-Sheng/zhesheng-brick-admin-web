"use strict";(self.webpackChunkvue_admin_better=self.webpackChunkvue_admin_better||[]).push([["2337"],{86803:function(e,t,o){var a=o(5563),l=o.n(a),r=o(47444),i=o.n(r)()(l());i.push([e.id,".workflow-container[data-v-58babf0a]{padding:20px}.workflow-container .card-header[data-v-58babf0a]{display:flex;justify-content:space-between;align-items:center;font-weight:bold}.workflow-container .workflow-name[data-v-58babf0a]{display:flex;align-items:center}.workflow-container .workflow-description[data-v-58babf0a]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;text-overflow:ellipsis}.workflow-container .workflow-icon-detail[data-v-58babf0a]{text-align:center}.workflow-container .pagination-container[data-v-58babf0a]{margin-top:20px;text-align:right}.workflow-container .node-list .node-item[data-v-58babf0a]{display:flex;align-items:center;margin-bottom:15px;padding:10px;border:1px solid #ebeef5;border-radius:4px}.workflow-container .node-list .node-item .node-handle[data-v-58babf0a]{cursor:move;margin-right:10px;color:#999}.workflow-container .node-list .node-item .node-content[data-v-58babf0a]{flex:1}.workflow-container .node-list .node-item .node-content[data-v-58babf0a] .el-form-item{margin-bottom:10px}.workflow-container .node-list .node-item .node-actions[data-v-58babf0a]{margin-left:10px}.workflow-container .workflow-diagram[data-v-58babf0a]{display:flex;flex-direction:column;align-items:center}.workflow-container .workflow-diagram .workflow-node[data-v-58babf0a]{width:300px;padding:15px;margin:10px 0;border:1px solid #ebeef5;border-radius:4px;cursor:pointer;transition:all .3s}.workflow-container .workflow-diagram .workflow-node[data-v-58babf0a]:hover{box-shadow:0 2px 12px 0 rgba(0,0,0,.1)}.workflow-container .workflow-diagram .workflow-node.active[data-v-58babf0a]{border-color:#409eff;box-shadow:0 0 0 2px #c6e2ff}.workflow-container .workflow-diagram .workflow-node .node-index[data-v-58babf0a]{display:inline-block;width:20px;height:20px;line-height:20px;text-align:center;background-color:#409eff;color:#fff;border-radius:50%;font-size:12px;margin-right:10px}.workflow-container .workflow-diagram .workflow-node .node-name[data-v-58babf0a]{font-weight:bold;margin-bottom:5px}.workflow-container .workflow-diagram .workflow-node .node-assignee[data-v-58babf0a]{font-size:12px;color:#666}",""]),t.A=i},63608:function(e,t,o){o.r(t),o.d(t,{default:function(){return K}});var a=o(7174);let l={class:"workflow-container"},r={class:"card-header"},i={class:"header-actions"},d={class:"workflow-name"},n={style:{"margin-left":"10px"}},s={class:"workflow-description"},c={class:"workflow-name"},w={style:{"margin-left":"10px"}},p={class:"workflow-name"},f={style:{"margin-left":"10px"}},m={class:"pagination-container"},u={class:"node-list"},h={class:"node-item"},g={class:"node-handle"},V={class:"node-content"},k={class:"node-actions"},x={style:{"margin-top":"15px"}},N={class:"dialog-footer"},C={class:"workflow-diagram"},b=["onClick"],y={class:"node-index"},v={class:"node-name"},T={class:"node-assignee"},_={key:0},S={key:1},W={key:2},D={class:"dialog-footer"};var E=o(5059),F=o(38602),B=o.n(F),U={name:"Workflow",components:{Search:E.Search,Connection:E.Connection,Rank:E.Rank,Delete:E.Delete,draggable:B()},data:()=>({activeTab:"all",workflowActiveTab:"diagram",searchText:"",currentPage:1,pageSize:10,totalWorkflows:0,loading:!1,workflowDialogVisible:!1,detailDialogVisible:!1,activeNodeIndex:0,editingWorkflow:null,workflows:[{id:1,name:"请假申请",description:"员工请假申请审批流程",status:"published",creator:"张三",createTime:"2023-05-01 10:00:00",color:"#409EFF",visibility:"public",nodes:[{id:1,name:"提交申请",assigneeType:"user",assignee:1},{id:2,name:"直属上级审批",assigneeType:"role",role:"manager"},{id:3,name:"人事审批",assigneeType:"role",role:"admin"}]},{id:2,name:"报销申请",description:"员工费用报销审批流程",status:"published",creator:"李四",createTime:"2023-05-05 14:30:00",color:"#67C23A",visibility:"public",nodes:[{id:1,name:"提交报销",assigneeType:"user",assignee:2},{id:2,name:"部门经理审批",assigneeType:"role",role:"manager"},{id:3,name:"财务审批",assigneeType:"role",role:"admin"}]},{id:3,name:"入职流程",description:"新员工入职办理流程",status:"draft",creator:"王五",createTime:"2023-05-10 09:15:00",color:"#E6A23C",visibility:"private",nodes:[{id:1,name:"填写入职信息",assigneeType:"user",assignee:3},{id:2,name:"部门分配",assigneeType:"role",role:"manager"},{id:3,name:"IT设备分配",assigneeType:"role",role:"admin"},{id:4,name:"人事手续办理",assigneeType:"role",role:"admin"}]}],users:[{id:1,name:"张三"},{id:2,name:"李四"},{id:3,name:"王五"},{id:4,name:"赵六"},{id:5,name:"钱七"}],workflowForm:{name:"",description:"",status:"draft",creator:"当前用户",color:"#409EFF",visibility:"public",nodes:[]},detailWorkflow:{},workflowRules:{name:[{required:!0,message:"请输入工作流名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},workflowInstances:[{id:1001,title:"张三的年假申请",currentNodeId:2,status:"in-progress",startTime:"2023-05-15 09:30:00"},{id:1002,title:"李四的差旅报销",currentNodeId:3,status:"in-progress",startTime:"2023-05-16 14:20:00"},{id:1003,title:"王五的病假申请",currentNodeId:1,status:"completed",startTime:"2023-05-10 11:45:00",endTime:"2023-05-10 16:30:00"}]}),computed:{filteredWorkflows(){let e=this.workflows;this.searchText&&(e=e.filter(e=>e.name.toLowerCase().includes(this.searchText.toLowerCase())||e.description.toLowerCase().includes(this.searchText.toLowerCase())));let t=(this.currentPage-1)*this.pageSize,o=t+this.pageSize;return e.slice(t,o)},myWorkflows(){return this.workflows.filter(e=>"张三"===e.creator)},participatedWorkflows(){return this.workflows.filter(e=>e.nodes.some(e=>"user"===e.assigneeType&&1===e.assignee||"role"===e.assigneeType&&"admin"===e.role))}},methods:{handleTabChange(e){this.activeTab=e,this.currentPage=1},handleSizeChange(e){this.pageSize=e,this.currentPage=1},handleCurrentChange(e){this.currentPage=e},getStatusText:e=>({draft:"草稿",published:"已发布",disabled:"已停用"})[e]||e,getStatusType:e=>({draft:"info",published:"success",disabled:"danger"})[e]||"info",getInstanceStatusText:e=>({pending:"待处理","in-progress":"进行中",completed:"已完成",rejected:"已拒绝"})[e]||e,getInstanceStatusType:e=>({pending:"info","in-progress":"warning",completed:"success",rejected:"danger"})[e]||"info",getRoleText:e=>({admin:"管理员",manager:"经理",employee:"员工"})[e]||e,getMyRole:e=>"张三"===e.creator?"创建者":"处理人",getUserById(e){return this.users.find(t=>t.id===e)},getCurrentNodeName(e){if(!this.detailWorkflow.nodes)return"";let t=this.detailWorkflow.nodes.find(t=>t.id===e);return t?t.name:""},showAddWorkflowDialog(){this.editingWorkflow=null,this.workflowForm={name:"",description:"",status:"draft",creator:"当前用户",color:"#409EFF",visibility:"public",nodes:[{id:Date.now(),name:"节点1",assigneeType:"user",assignee:1}]},this.workflowDialogVisible=!0,this.$nextTick(()=>{this.$refs.workflowFormRef.resetFields()})},editWorkflow(e){this.editingWorkflow=e,this.workflowForm=JSON.parse(JSON.stringify(e)),this.workflowDialogVisible=!0},viewWorkflow(e){this.detailWorkflow={...e},this.detailDialogVisible=!0},startWorkflow(e){this.$message.success(`已启动工作流: ${e.name}`)},processWorkflow(e){this.$message.success(`开始处理工作流: ${e.name}`)},deleteWorkflow(e){this.$confirm(`确定要删除工作流"${e.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=this.workflows.findIndex(t=>t.id===e.id);-1!==t&&(this.workflows.splice(t,1),this.totalWorkflows=this.workflows.length,this.$message.success("工作流删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},saveWorkflow(){this.$refs.workflowFormRef.validate(e=>{if(e){if(this.editingWorkflow){let e=this.workflows.findIndex(e=>e.id===this.editingWorkflow.id);-1!==e&&(this.workflows[e]={...this.editingWorkflow,...this.workflowForm},this.$message.success("工作流更新成功"))}else{let e={id:Date.now(),createTime:new Date().toLocaleString(),...this.workflowForm};this.workflows.push(e),this.totalWorkflows=this.workflows.length,this.$message.success("工作流创建成功")}this.workflowDialogVisible=!1}})},addNode(){this.workflowForm.nodes.push({id:Date.now()+Math.random(),name:`节点${this.workflowForm.nodes.length+1}`,assigneeType:"user",assignee:1})},removeNode(e){this.workflowForm.nodes.length<=1?this.$message.warning("至少需要保留一个节点"):this.workflowForm.nodes.splice(e,1)},viewInstance(e){this.$message.info(`查看实例: ${e.id}`)}}},I=o(7368),$=o.n(I),z=o(60473),A=o.n(z),R=o(62915),P=o.n(R),L=o(14808),q=o.n(L),j=o(85364),M=o.n(j),J=o(78577),O=o.n(J),G=o(86803),H={};H.styleTagTransform=O(),H.setAttributes=q(),H.insert=P().bind(null,"head"),H.domAPI=A(),H.insertStyleElement=M(),$()(G.A,H),G.A&&G.A.locals&&G.A.locals;var K=(0,o(92260).default)(U,[["render",function(e,t,o,E,F,B){let U=(0,a.resolveComponent)("Search"),I=(0,a.resolveComponent)("el-icon"),$=(0,a.resolveComponent)("el-input"),z=(0,a.resolveComponent)("el-button"),A=(0,a.resolveComponent)("Connection"),R=(0,a.resolveComponent)("el-table-column"),P=(0,a.resolveComponent)("el-tag"),L=(0,a.resolveComponent)("el-table"),q=(0,a.resolveComponent)("el-tab-pane"),j=(0,a.resolveComponent)("el-tabs"),M=(0,a.resolveComponent)("el-pagination"),J=(0,a.resolveComponent)("el-card"),O=(0,a.resolveComponent)("el-form-item"),G=(0,a.resolveComponent)("el-col"),H=(0,a.resolveComponent)("el-option"),K=(0,a.resolveComponent)("el-select"),Q=(0,a.resolveComponent)("el-color-picker"),X=(0,a.resolveComponent)("el-row"),Y=(0,a.resolveComponent)("el-divider"),Z=(0,a.resolveComponent)("Rank"),ee=(0,a.resolveComponent)("draggable"),et=(0,a.resolveComponent)("el-form"),eo=(0,a.resolveComponent)("el-dialog"),ea=(0,a.resolveComponent)("el-descriptions-item"),el=(0,a.resolveComponent)("el-descriptions"),er=(0,a.resolveDirective)("loading");return(0,a.openBlock)(),(0,a.createElementBlock)("div",l,[(0,a.createVNode)(J,{shadow:"never"},{header:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",r,[t[17]||(t[17]=(0,a.createElementVNode)("span",null,"工作流",-1)),(0,a.createElementVNode)("div",i,[(0,a.createVNode)($,{modelValue:F.searchText,"onUpdate:modelValue":t[0]||(t[0]=e=>F.searchText=e),placeholder:"搜索工作流...",clearable:"",style:{width:"200px","margin-right":"10px"}},{prefix:(0,a.withCtx)(()=>[(0,a.createVNode)(I,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(U)]),_:1})]),_:1},8,["modelValue"]),(0,a.createVNode)(z,{type:"primary",onClick:B.showAddWorkflowDialog},{default:(0,a.withCtx)(()=>[...t[16]||(t[16]=[(0,a.createTextVNode)("创建工作流",-1)])]),_:1},8,["onClick"])])])]),default:(0,a.withCtx)(()=>[(0,a.createVNode)(j,{modelValue:F.activeTab,"onUpdate:modelValue":t[1]||(t[1]=e=>F.activeTab=e),onTabChange:B.handleTabChange},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(q,{label:"所有工作流",name:"all"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(L,{data:B.filteredWorkflows,style:{width:"100%"},"row-key":"id"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{prop:"name",label:"工作流名称","min-width":"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("div",d,[(0,a.createVNode)(I,{color:e.color},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(A)]),_:1},8,["color"]),(0,a.createElementVNode)("span",n,(0,a.toDisplayString)(e.name),1)])]),_:1}),(0,a.createVNode)(R,{prop:"description",label:"描述","min-width":"250"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("div",s,(0,a.toDisplayString)(e.description),1)]),_:1}),(0,a.createVNode)(R,{label:"状态",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(P,{type:B.getStatusType(e.status)},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,a.createVNode)(R,{prop:"creator",label:"创建者",width:"120"}),(0,a.createVNode)(R,{prop:"createTime",label:"创建时间",width:"180"}),(0,a.createVNode)(R,{label:"操作",width:"250"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(z,{type:"text",onClick:t=>B.viewWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[18]||(t[18]=[(0,a.createTextVNode)("查看",-1)])]),_:1},8,["onClick"]),(0,a.createVNode)(z,{type:"text",onClick:t=>B.editWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[19]||(t[19]=[(0,a.createTextVNode)("编辑",-1)])]),_:1},8,["onClick"]),(0,a.createVNode)(z,{type:"text",onClick:t=>B.startWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[20]||(t[20]=[(0,a.createTextVNode)("启动",-1)])]),_:1},8,["onClick"]),(0,a.createVNode)(z,{type:"text",onClick:t=>B.deleteWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[21]||(t[21]=[(0,a.createTextVNode)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[er,F.loading]])]),_:1}),(0,a.createVNode)(q,{label:"我创建的",name:"created"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(L,{data:B.myWorkflows,style:{width:"100%"},"row-key":"id"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{prop:"name",label:"工作流名称","min-width":"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("div",c,[(0,a.createVNode)(I,{color:e.color},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(A)]),_:1},8,["color"]),(0,a.createElementVNode)("span",w,(0,a.toDisplayString)(e.name),1)])]),_:1}),(0,a.createVNode)(R,{prop:"description",label:"描述","min-width":"250"}),(0,a.createVNode)(R,{label:"状态",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(P,{type:B.getStatusType(e.status)},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,a.createVNode)(R,{prop:"createTime",label:"创建时间",width:"180"}),(0,a.createVNode)(R,{label:"操作",width:"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(z,{type:"text",onClick:t=>B.viewWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[22]||(t[22]=[(0,a.createTextVNode)("查看",-1)])]),_:1},8,["onClick"]),(0,a.createVNode)(z,{type:"text",onClick:t=>B.editWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[23]||(t[23]=[(0,a.createTextVNode)("编辑",-1)])]),_:1},8,["onClick"]),(0,a.createVNode)(z,{type:"text",onClick:t=>B.startWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[24]||(t[24]=[(0,a.createTextVNode)("启动",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),(0,a.createVNode)(q,{label:"我参与的",name:"participated"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(L,{data:B.participatedWorkflows,style:{width:"100%"},"row-key":"id"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{prop:"name",label:"工作流名称","min-width":"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("div",p,[(0,a.createVNode)(I,{color:e.color},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(A)]),_:1},8,["color"]),(0,a.createElementVNode)("span",f,(0,a.toDisplayString)(e.name),1)])]),_:1}),(0,a.createVNode)(R,{prop:"description",label:"描述","min-width":"250"}),(0,a.createVNode)(R,{label:"我的角色",width:"120"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(P,null,{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getMyRole(e)),1)]),_:2},1024)]),_:1}),(0,a.createVNode)(R,{label:"状态",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(P,{type:B.getStatusType(e.status)},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,a.createVNode)(R,{prop:"creator",label:"创建者",width:"120"}),(0,a.createVNode)(R,{label:"操作",width:"150"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(z,{type:"text",onClick:t=>B.viewWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[25]||(t[25]=[(0,a.createTextVNode)("查看",-1)])]),_:1},8,["onClick"]),(0,a.createVNode)(z,{type:"text",onClick:t=>B.processWorkflow(e)},{default:(0,a.withCtx)(()=>[...t[26]||(t[26]=[(0,a.createTextVNode)("处理",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue","onTabChange"]),(0,a.createElementVNode)("div",m,[(0,a.createVNode)(M,{"current-page":F.currentPage,"onUpdate:currentPage":t[2]||(t[2]=e=>F.currentPage=e),"page-size":F.pageSize,"onUpdate:pageSize":t[3]||(t[3]=e=>F.pageSize=e),"page-sizes":[10,20,50,100],total:F.totalWorkflows,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:B.handleSizeChange,onCurrentChange:B.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),(0,a.createCommentVNode)(" 添加/编辑工作流对话框 "),(0,a.createVNode)(eo,{modelValue:F.workflowDialogVisible,"onUpdate:modelValue":t[12]||(t[12]=e=>F.workflowDialogVisible=e),title:F.editingWorkflow?"编辑工作流":"创建工作流",width:"800px"},{footer:(0,a.withCtx)(()=>[(0,a.createElementVNode)("span",N,[(0,a.createVNode)(z,{onClick:t[11]||(t[11]=e=>F.workflowDialogVisible=!1)},{default:(0,a.withCtx)(()=>[...t[29]||(t[29]=[(0,a.createTextVNode)("取消",-1)])]),_:1}),(0,a.createVNode)(z,{type:"primary",onClick:B.saveWorkflow},{default:(0,a.withCtx)(()=>[...t[30]||(t[30]=[(0,a.createTextVNode)(" 保存 ",-1)])]),_:1},8,["onClick"])])]),default:(0,a.withCtx)(()=>[(0,a.createVNode)(et,{ref:"workflowFormRef",model:F.workflowForm,rules:F.workflowRules,"label-width":"100px"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(X,{gutter:20},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(G,{span:12},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(O,{label:"工作流名称",prop:"name"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)($,{modelValue:F.workflowForm.name,"onUpdate:modelValue":t[4]||(t[4]=e=>F.workflowForm.name=e)},null,8,["modelValue"])]),_:1}),(0,a.createVNode)(O,{label:"描述",prop:"description"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)($,{modelValue:F.workflowForm.description,"onUpdate:modelValue":t[5]||(t[5]=e=>F.workflowForm.description=e),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),(0,a.createVNode)(O,{label:"创建者"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)($,{modelValue:F.workflowForm.creator,"onUpdate:modelValue":t[6]||(t[6]=e=>F.workflowForm.creator=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),(0,a.createVNode)(G,{span:12},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(O,{label:"状态"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(K,{modelValue:F.workflowForm.status,"onUpdate:modelValue":t[7]||(t[7]=e=>F.workflowForm.status=e),placeholder:"请选择状态",style:{width:"100%"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(H,{label:"草稿",value:"draft"}),(0,a.createVNode)(H,{label:"已发布",value:"published"}),(0,a.createVNode)(H,{label:"已停用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),(0,a.createVNode)(O,{label:"工作流颜色"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Q,{modelValue:F.workflowForm.color,"onUpdate:modelValue":t[8]||(t[8]=e=>F.workflowForm.color=e)},null,8,["modelValue"])]),_:1}),(0,a.createVNode)(O,{label:"可见范围"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(K,{modelValue:F.workflowForm.visibility,"onUpdate:modelValue":t[9]||(t[9]=e=>F.workflowForm.visibility=e),placeholder:"请选择可见范围",style:{width:"100%"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(H,{label:"所有人",value:"public"}),(0,a.createVNode)(H,{label:"仅创建者",value:"private"}),(0,a.createVNode)(H,{label:"指定部门",value:"department"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,a.createVNode)(Y,null,{default:(0,a.withCtx)(()=>[...t[27]||(t[27]=[(0,a.createTextVNode)("流程节点",-1)])]),_:1}),(0,a.createElementVNode)("div",u,[(0,a.createVNode)(ee,{modelValue:F.workflowForm.nodes,"onUpdate:modelValue":t[10]||(t[10]=e=>F.workflowForm.nodes=e),"item-key":"id",handle:".node-handle"},{item:(0,a.withCtx)(({element:e,index:t})=>[(0,a.createElementVNode)("div",h,[(0,a.createElementVNode)("div",g,[(0,a.createVNode)(I,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Z)]),_:1})]),(0,a.createElementVNode)("div",V,[(0,a.createVNode)(O,{prop:`nodes.${t}.name`,rules:[{required:!0,message:"请输入节点名称",trigger:"blur"}]},{default:(0,a.withCtx)(()=>[(0,a.createVNode)($,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,placeholder:"节点名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),(0,a.createVNode)(O,{prop:`nodes.${t}.assigneeType`,rules:[{required:!0,message:"请选择处理人类型",trigger:"change"}]},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(K,{modelValue:e.assigneeType,"onUpdate:modelValue":t=>e.assigneeType=t,placeholder:"处理人类型",style:{width:"100%"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(H,{label:"指定人员",value:"user"}),(0,a.createVNode)(H,{label:"指定角色",value:"role"}),(0,a.createVNode)(H,{label:"表单字段",value:"field"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),"user"===e.assigneeType?((0,a.openBlock)(),(0,a.createBlock)(O,{key:0,prop:`nodes.${t}.assignee`,rules:[{required:!0,message:"请选择处理人",trigger:"change"}]},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(K,{modelValue:e.assignee,"onUpdate:modelValue":t=>e.assignee=t,placeholder:"处理人",style:{width:"100%"}},{default:(0,a.withCtx)(()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(F.users,e=>((0,a.openBlock)(),(0,a.createBlock)(H,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(0,a.createCommentVNode)("v-if",!0),"role"===e.assigneeType?((0,a.openBlock)(),(0,a.createBlock)(O,{key:1,prop:`nodes.${t}.role`,rules:[{required:!0,message:"请选择角色",trigger:"change"}]},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(K,{modelValue:e.role,"onUpdate:modelValue":t=>e.role=t,placeholder:"角色",style:{width:"100%"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(H,{label:"管理员",value:"admin"}),(0,a.createVNode)(H,{label:"经理",value:"manager"}),(0,a.createVNode)(H,{label:"员工",value:"employee"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",k,[(0,a.createVNode)(z,{type:"danger",icon:"Delete",circle:"",onClick:e=>B.removeNode(t)},null,8,["onClick"])])])]),_:1},8,["modelValue"]),(0,a.createElementVNode)("div",x,[(0,a.createVNode)(z,{type:"primary",onClick:B.addNode},{default:(0,a.withCtx)(()=>[...t[28]||(t[28]=[(0,a.createTextVNode)("添加节点",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),(0,a.createCommentVNode)(" 工作流详情对话框 "),(0,a.createVNode)(eo,{modelValue:F.detailDialogVisible,"onUpdate:modelValue":t[15]||(t[15]=e=>F.detailDialogVisible=e),title:"工作流详情",width:"800px"},{footer:(0,a.withCtx)(()=>[(0,a.createElementVNode)("span",D,[(0,a.createVNode)(z,{onClick:t[14]||(t[14]=e=>F.detailDialogVisible=!1)},{default:(0,a.withCtx)(()=>[...t[32]||(t[32]=[(0,a.createTextVNode)("关闭",-1)])]),_:1})])]),default:(0,a.withCtx)(()=>[(0,a.createVNode)(X,{gutter:20},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(G,{span:16},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(el,{column:1,border:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(ea,{label:"工作流名称"},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(F.detailWorkflow.name),1)]),_:1}),(0,a.createVNode)(ea,{label:"描述"},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(F.detailWorkflow.description),1)]),_:1}),(0,a.createVNode)(ea,{label:"创建者"},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(F.detailWorkflow.creator),1)]),_:1}),(0,a.createVNode)(ea,{label:"状态"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(P,{type:B.getStatusType(F.detailWorkflow.status)},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getStatusText(F.detailWorkflow.status)),1)]),_:1},8,["type"])]),_:1}),(0,a.createVNode)(ea,{label:"创建时间"},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(F.detailWorkflow.createTime),1)]),_:1})]),_:1})]),_:1}),(0,a.createVNode)(G,{span:8},{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",{class:"workflow-icon-detail",style:(0,a.normalizeStyle)({color:F.detailWorkflow.color})},[(0,a.createVNode)(I,{size:60},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(A)]),_:1})],4)]),_:1})]),_:1}),(0,a.createVNode)(j,{modelValue:F.workflowActiveTab,"onUpdate:modelValue":t[13]||(t[13]=e=>F.workflowActiveTab=e),style:{"margin-top":"20px"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(q,{label:"流程图",name:"diagram"},{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",C,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(F.detailWorkflow.nodes,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["workflow-node",{active:F.activeNodeIndex===t}]),onClick:e=>F.activeNodeIndex=t},[(0,a.createElementVNode)("div",y,(0,a.toDisplayString)(t+1),1),(0,a.createElementVNode)("div",v,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("div",T,["user"===e.assigneeType?((0,a.openBlock)(),(0,a.createElementBlock)("span",_," 处理人: "+(0,a.toDisplayString)(B.getUserById(e.assignee)?.name||"未指定"),1)):"role"===e.assigneeType?((0,a.openBlock)(),(0,a.createElementBlock)("span",S," 角色: "+(0,a.toDisplayString)(B.getRoleText(e.role)),1)):((0,a.openBlock)(),(0,a.createElementBlock)("span",W," 字段: "+(0,a.toDisplayString)(e.field||"未指定"),1))])],10,b))),128))])]),_:1}),(0,a.createVNode)(q,{label:"实例",name:"instances"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(L,{data:F.workflowInstances,style:{width:"100%"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{prop:"id",label:"实例ID",width:"100"}),(0,a.createVNode)(R,{prop:"title",label:"标题"}),(0,a.createVNode)(R,{label:"当前节点",width:"150"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getCurrentNodeName(e.currentNodeId)),1)]),_:1}),(0,a.createVNode)(R,{label:"状态",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(P,{type:B.getInstanceStatusType(e.status)},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(B.getInstanceStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,a.createVNode)(R,{prop:"startTime",label:"开始时间",width:"180"}),(0,a.createVNode)(R,{label:"操作",width:"150"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(z,{type:"text",onClick:t=>B.viewInstance(e)},{default:(0,a.withCtx)(()=>[...t[31]||(t[31]=[(0,a.createTextVNode)("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}],["__scopeId","data-v-58babf0a"]])}}]);