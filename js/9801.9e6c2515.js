"use strict";(self.webpackChunkvue_admin_better=self.webpackChunkvue_admin_better||[]).push([["9801"],{58315:function(e,a,t){t.r(a),t.d(a,{createForm:function(){return u},deleteForm:function(){return d},getForm:function(){return r},getForms:function(){return l},updateForm:function(){return o}});var n=t(49289);function l(e={}){return n.default.get("/form",{params:e}).then(e=>e.data)}function r(e){return n.default.get(`/form/${e}`).then(e=>e.data)}function u(e){return n.default.post("/form",e).then(e=>e.data)}function o(e,a){return n.default.patch(`/form/${e}`,a).then(e=>e.data)}function d(e){return n.default.delete(`/form/${e}`).then(()=>!0)}},23827:function(e,a,t){var n=t(26741),l=t.n(n),r=t(63494),u=t.n(r)()(l());u.push([e.id,".designer-page[data-v-6403c753]{display:flex;flex-direction:column;gap:12px;padding:12px}.topbar[data-v-6403c753]{display:flex;align-items:center;gap:8px}.grow[data-v-6403c753]{flex:1}.w-56[data-v-6403c753]{width:260px}.w-40[data-v-6403c753]{width:200px}.w-72[data-v-6403c753]{width:320px}.designer-wrap[data-v-6403c753]{background:#fff;border:1px solid #ebeef5;border-radius:8px;padding:12px}.designer-root[data-v-6403c753]{width:100%;height:auto;min-height:700px;display:block}[data-v-6403c753] .fc-designer,[data-v-6403c753] .fc-container,[data-v-6403c753] .form-create{min-height:700px}.preview-missing[data-v-6403c753]{font-size:13px;color:#666;background:#f9fafb;border:1px dashed #e5e7eb;border-radius:8px;padding:12px;white-space:pre-wrap}",""]),a.A=u},46032:function(e,a,t){t.r(a),t.d(a,{default:function(){return _}});var n=t(65611),l=t(10365),r=t(67312),u=t(58315);let o={class:"designer-page"},d={class:"topbar"},i={class:"designer-wrap"},c={key:0,class:"preview-missing"};var s=t(66270),p=t.n(s),m=t(38007),f=t.n(m),v=t(92669),g=t.n(v),w=t(23566),h=t.n(w),b=t(76106),k=t.n(b),y=t(12527),x=t.n(y),F=t(23827),V={};V.styleTagTransform=x(),V.setAttributes=h(),V.insert=g().bind(null,"head"),V.domAPI=f(),V.insertStyleElement=k(),p()(F.A,V),F.A&&F.A.locals&&F.A.locals;var _=(0,t(4786).default)({__name:"index",setup(e){let a=(0,l.lq)(),t=(0,l.rd)(),s=(0,n.KR)(a.query.id?String(a.query.id):null),p=(0,n.EW)(()=>"new"===a.query.mode||!s.value),m=(0,n.KR)(null),f=(0,n.KR)({name:"",teamName:"",description:""}),v=(0,n.KR)(!1),g=(0,n.KR)(!1),w=(0,n.KR)({}),h=(0,n.KR)([]),b=(0,n.KR)({}),k=!!("undefined"!=typeof window&&(window.formCreate||window.$formCreate));async function y(){let e=m.value?.getRule?.()||[],a=m.value?.getOption?.()||{};if(!f.value.name||!f.value.teamName)return void r.n.warning("请填写模板名称和团队名称");v.value=!0;try{p.value?(await (0,u.createForm)({...f.value,ruleJson:e,optionJson:a}),r.n.success("模板创建成功"),t.back()):(await (0,u.updateForm)(s.value,{...f.value,ruleJson:e,optionJson:a}),r.n.success("模板更新成功"))}catch(e){r.n.error("保存失败："+(e?.message||"接口异常"))}finally{v.value=!1}}function x(){if(!k){r.n.warning("未注册 form-create 渲染器，无法预览"),g.value=!0;return}h.value=m.value?.getRule?.()||[],b.value=m.value?.getOption?.()||{},g.value=!0}function F(){t.back()}return(0,n.sV)(async()=>{if(!p.value&&s.value)try{let e=await (0,u.getForm)(s.value);f.value={name:e.name||"",teamName:e.teamName||"",description:e.description||""},await (0,n.dY)(),m.value?.setRule?.(e.ruleJson||[]),m.value?.setOption?.(e.optionJson||{})}catch(e){r.n.error("加载模板失败："+(e?.message||"接口异常"))}"true"===a.query.preview&&x()}),(e,a)=>{let t=(0,n.g2)("el-page-header"),l=(0,n.g2)("el-input"),r=(0,n.g2)("el-button"),u=(0,n.g2)("fc-designer"),s=(0,n.g2)("form-create"),V=(0,n.g2)("el-dialog");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.Q3)(" 顶部工具栏 "),(0,n.Lk)("div",d,[(0,n.bF)(t,{onBack:F},{content:(0,n.k6)(()=>[(0,n.Lk)("span",null,(0,n.v_)(p.value?"新建模板":"编辑模板"),1)]),_:1}),a[7]||(a[7]=(0,n.Lk)("div",{class:"grow"},null,-1)),(0,n.bF)(l,{modelValue:f.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.name=e),placeholder:"模板名称",class:"w-56"},null,8,["modelValue"]),(0,n.bF)(l,{modelValue:f.value.teamName,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value.teamName=e),placeholder:"团队名称",class:"w-40"},null,8,["modelValue"]),(0,n.bF)(l,{modelValue:f.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>f.value.description=e),placeholder:"模板描述",class:"w-72"},null,8,["modelValue"]),(0,n.bF)(r,{loading:v.value,type:"primary",onClick:y},{default:(0,n.k6)(()=>[...a[5]||(a[5]=[(0,n.eW)("保存",-1)])]),_:1},8,["loading"]),(0,n.bF)(r,{onClick:x},{default:(0,n.k6)(()=>[...a[6]||(a[6]=[(0,n.eW)("预览",-1)])]),_:1})]),(0,n.Q3)(" 设计器区域：不再缩放，不再内滚动，自然铺开 "),(0,n.Lk)("div",i,[(0,n.bF)(u,{ref_key:"designerRef",ref:m,class:"designer-root"},null,512)]),(0,n.Q3)(" 预览弹窗 "),(0,n.bF)(V,{modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=e=>g.value=e),width:"70%",title:"表单预览","destroy-on-close":""},{default:(0,n.k6)(()=>[k?((0,n.uX)(),(0,n.Wv)(s,{key:1,modelValue:w.value,"onUpdate:modelValue":a[3]||(a[3]=e=>w.value=e),rule:h.value,option:b.value},null,8,["modelValue","rule","option"])):((0,n.uX)(),(0,n.CE)("div",c,[...a[8]||(a[8]=[(0,n.eW)(" 未检测到 form-create 渲染器。请在 main.js 注册后再试： ",-1),(0,n.Lk)("pre",null,"import formCreate from '@form-create/element-ui'\napp.use(formCreate)",-1)])]))]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-6403c753"]])}}]);